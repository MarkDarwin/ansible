- name: Install required packages
  ansible.builtin.apt:
    name:
      - apt-transport-https
      - ca-certificates
    state: present
    update_cache: true

- name: Add HashiCorp repository (modern method)
  ansible.builtin.deb822_repository:
    name: hashicorp
    types: [deb]
    uris: "https://apt.releases.hashicorp.com"
    suites: "{{ ansible_distribution_release }}"
    components: [main]
    architectures: amd64
    signed_by: "https://apt.releases.hashicorp.com/gpg"
    state: present
    enabled: true

- name: Update apt cache
  ansible.builtin.apt:
    update_cache: true

- name: Install Terraform
  ansible.builtin.apt:
    name: terraform
    state: latest
